---
description: 需求文档
globs: 
alwaysApply: false
---
# 需求文档 - Gemini 内容导出与美化插件

**1. 项目概述**

本项目的目标是开发一款浏览器插件，旨在扩展 Gemini 对话页面的功能。该插件将允许用户方便地将 Gemini 生成的深度研究报告或单条回答，快速导出为 Markdown 格式的文本，或在经过自定义美化后导出为图片。插件将兼容主流的 Chromium 内核浏览器，如 Google Chrome 和 Microsoft Edge。

**2. 目标用户**

*   经常使用 Gemini 进行研究、学习和内容创作的用户。
*   希望快速分享、存档 Gemini 输出内容的用户。
*   追求个性化和美观的分享效果的用户。

**3. 功能需求**

*   **3.1. 内容识别与选择**
    *   **3.1.1. 自动识别**: 插件需要能够自动识别 Gemini 页面中的可导出内容单元，包括：
        *   完整的"深度研究"报告。
        *   Gemini 的单条回答。
    *   **3.1.2. 触发方式**:
        *   **集成增强**: 插件将优先考虑增强 Gemini 原生回答框或报告下方的现有"复制"和"分享"按钮/图标。
            *   例如，在用户点击 Gemini 的"复制"按钮后，插件可以弹出一个小菜单，提供"复制原文 (Markdown)"和"复制为 Markdown"的选项。
            *   或者，在现有的按钮旁边增加一个新的"导出增强"图标，点击后展开"导出为 Markdown"和"导出为图片"的选项。
        *   (可选) 支持通过右键菜单触发导出功能。
    *   **3.1.3. 清晰指示**: 鼠标悬停在增强的按钮或新图标上时，应有清晰的提示文字说明其功能，并明确标示出将被导出的内容范围。

*   **3.2. 导出为 Markdown 文本**
    *   **3.2.1. 格式保真**: 准确提取选中内容的文本，并尽可能保留原有的 Markdown 基本格式，如标题、列表、代码块、引用、粗体、斜体等。
    *   **3.2.2. 快速复制**: 提供"复制到剪贴板"按钮，用户点击后即可将转换后的 Markdown 文本复制。
    *   **3.2.3. (可选) 下载文件**: 提供"下载 .md 文件"按钮，将 Markdown 内容保存为本地文件。

*   **3.3. 导出为图片**
    *   **3.3.1. 内容捕获**: 用户选择导出为图片时，插件首先准确捕获选定的 HTML 内容。
    *   **3.3.2. 图片生成与导出**:
        *   **生成**: 插件在客户端使用如 `html2canvas` 或类似技术将捕获的 HTML 内容直接渲染为图片。可以考虑应用一个默认的、简洁美观的样式。
        *   **格式**: 支持导出为 PNG 或 JPEG 格式（可提供选项或使用默认）。
        *   **下载**: 提供"下载图片"按钮。
        *   **复制**: 提供"复制图片到剪贴板"功能 (尽力实现)。

*   **3.4. 插件管理与交互**
    *   **3.4.1. 插件图标**: 在浏览器工具栏显示插件图标。
    *   **3.4.2. 弹出菜单**: (可选) 点击插件图标可进行简易设置，如默认导出格式、图片质量等，或提供帮助/关于信息。
    *   **3.4.3. 界面注入**: 导出按钮和相关 UI 元素的注入不应破坏 Gemini 原页面的布局和使用体验。

**4. 技术栈与实现**

*   **4.1. 核心技术**: HTML, CSS, JavaScript。
*   **4.2. 浏览器插件标准**: Manifest V3。
*   **4.3. 主要依赖库 (建议)**:
    *   `html2canvas` 或 `dom-to-image-more`: 用于将 DOM 内容转换为图片。
    *   `Turndown` (或类似库): 用于将 HTML 转换为 Markdown。
    *   (可选) 轻量级 UI 库/框架 (如 React, Vue, Svelte 或 Preact): 如果需要构建弹出菜单或其他非编辑器 UI。
*   **4.4. 内容脚本 (Content Scripts)**: 用于与 Gemini 页面交互，识别内容，注入按钮。
*   **4.5. 后台脚本 (Background Scripts/Service Worker)**: (如果需要) 处理一些后台逻辑，如跨页面通信或复杂计算。

**5. 非功能性需求**

*   **5.1. 性能**: 插件运行不应导致浏览器卡顿，图片生成过程应尽可能优化，避免长时间等待。
*   **5.2. 易用性**: 界面直观，操作简单，用户无需学习即可上手。
*   **5.3. 兼容性**: 良好兼容最新版的 Chrome 和 Edge 浏览器。在 Gemini 页面结构发生变化时，应有一定的兼容性或快速更新能力。
*   **5.4. 错误处理**: 对可能发生的错误（如内容捕获失败、图片生成失败）有适当的提示。
*   **5.5. 隐私**: 不收集用户非必要数据。所有操作尽量在本地完成。

**6. 未来可能的扩展**

*   支持导出为 PDF 格式。
*   提供图片编辑器功能，允许用户自定义样式（如背景、字体、布局、主题等）。
*   提供几种可选的图片导出主题/样式（如果编辑器功能未实现）。
*   用户自定义图片导出样式的保存与同步。
*   支持批量导出多个回答。
*   国际化支持（多语言界面）。
